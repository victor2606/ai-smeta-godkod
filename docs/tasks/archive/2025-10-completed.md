# –ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ - –û–∫—Ç—è–±—Ä—å 2025

## –§–ê–ó–ê 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ –¥–∞–Ω–Ω—ã—Ö ‚úÖ

### –ó–∞–¥–∞—á–∞ 1.1: –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞ ‚úÖ

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 2025-10-18

**–¶–µ–ª—å:** –û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å —Ñ–∞–π–ª–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞:**
- [x] –°–æ–∑–¥–∞–Ω—ã –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏: `data/`, `src/`, `agents/`, `tests/`, `docs/`, `scripts/`
- [x] –°–æ–∑–¥–∞–Ω—ã –ø–æ–¥–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏: `data/raw/`, `data/processed/`, `data/cache/`
- [x] –°–æ–∑–¥–∞–Ω—ã –ø–æ–¥–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏: `src/database/`, `src/etl/`, `src/search/`, `src/utils/`
- [x] –ü–µ—Ä–µ–º–µ—â–µ–Ω –∏—Å—Ö–æ–¥–Ω—ã–π Excel —Ñ–∞–π–ª –≤ `data/raw/`
- [x] –í—Å–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç `.gitkeep` —Ñ–∞–π–ª—ã –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ Git

**–ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã:**
- –ù–æ–≤—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- `data/raw/–°onstruction_Works_Rate_Schedule_Some_groups_17102025.xlsx` (–ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ)

---

### –ó–∞–¥–∞—á–∞ 1.2: –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö ‚úÖ

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 2025-10-19

**–¶–µ–ª—å:** –°–æ–∑–¥–∞—Ç—å SQL —Å—Ö–µ–º—É –¥–ª—è SQLite —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –ø–æ–¥ FTS5 –ø–æ–∏—Å–∫

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞:**
- [x] –§–∞–π–ª `src/database/schema.sql` —Å–æ–¥–µ—Ä–∂–∏—Ç DDL –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã `rates`
- [x] –¢–∞–±–ª–∏—Ü–∞ `rates` –∏–º–µ–µ—Ç –≤—Å–µ –∫–ª—é—á–µ–≤—ã–µ –ø–æ–ª—è: rate_code, rate_full_name, rate_short_name, unit_quantity, unit_type, total_cost, materials_cost, resources_cost, search_text
- [x] –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ `rates_fts` —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º FTS5
- [x] –ù–∞—Å—Ç—Ä–æ–µ–Ω —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä –¥–ª—è —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞ (unicode61 remove_diacritics 2)
- [x] –°–æ–∑–¥–∞–Ω—ã —Ç—Ä–∏–≥–≥–µ—Ä—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ FTS –∏–Ω–¥–µ–∫—Å–∞ (AFTER INSERT, AFTER UPDATE, AFTER DELETE)
- [x] –§–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç DDL –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã `resources` —Å –≤–Ω–µ—à–Ω–∏–º –∫–ª—é—á–æ–º –Ω–∞ `rates`
- [x] –°–æ–∑–¥–∞–Ω—ã –∏–Ω–¥–µ–∫—Å—ã: idx_rate_code, idx_unit_type, idx_category
- [x] –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü—ã –∏ –ø–æ–ª—è

**–ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã:**
- `src/database/schema.sql` (–Ω–æ–≤—ã–π)

---

### –ó–∞–¥–∞—á–∞ 1.3: –ú–µ–Ω–µ–¥–∂–µ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ –ë–î ‚úÖ

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 2025-10-19

**–¶–µ–ª—å:** –°–æ–∑–¥–∞—Ç—å —É—Ç–∏–ª–∏—Ç—É –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è SQLite –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è–º–∏

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞:**
- [x] –§–∞–π–ª `src/database/db_manager.py` —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–ª–∞—Å—Å `DatabaseManager`
- [x] –ö–ª–∞—Å—Å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç context manager –ø—Ä–æ—Ç–æ–∫–æ–ª (`__enter__`, `__exit__`)
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –º–µ—Ç–æ–¥—ã: `connect()`, `disconnect()`, `execute_query()`, `execute_many()`
- [x] –ú–µ—Ç–æ–¥ `initialize_schema()` —á–∏—Ç–∞–µ—Ç –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç `schema.sql`
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ë–î –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
- [x] –í–∫–ª—é—á–µ–Ω —Ä–µ–∂–∏–º WAL (Write-Ahead Logging) –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- [x] –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã pragma: journal_mode=WAL, synchronous=NORMAL, cache_size=-64000
- [x] –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å –ë–î
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π —Å –ø–æ–Ω—è—Ç–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏

**–ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã:**
- `src/database/db_manager.py` (–Ω–æ–≤—ã–π)

---

### –ó–∞–¥–∞—á–∞ 1.4: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è FTS5 ‚úÖ

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 2025-10-19

**–¶–µ–ª—å:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ–∏—Å–∫–∞

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞:**
- [x] –§–∞–π–ª `src/database/fts_config.py` —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é FTS5
- [x] –û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —Å—Ç–æ–ø-—Å–ª–æ–≤–∞ –¥–ª—è —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞ (–∏–∑, –≤, –Ω–∞, –ø–æ, —Å, –∫, –¥–ª—è, –∏ —Ç.–¥.)
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ (—É–¥–∞–ª–µ–Ω–∏–µ —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª–æ–≤, –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –∫ lowercase)
- [x] –°–æ–∑–¥–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è wildcard (*) –∫ —Å–ª–æ–≤–∞–º –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è prefix matching
- [x] –û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —Å–∏–Ω–æ–Ω–∏–º—ã: –ì–ö–õ‚Üî–≥–∏–ø—Å–æ–∫–∞—Ä—Ç–æ–Ω, –º2‚Üî–∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–π –º–µ—Ç—Ä, –º3‚Üî–∫—É–±–∏—á–µ—Å–∫–∏–π –º–µ—Ç—Ä
- [x] –§—É–Ω–∫—Ü–∏—è `prepare_fts_query(user_query)` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≥–æ—Ç–æ–≤—ã–π FTS5-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π –∑–∞–ø—Ä–æ—Å
- [x] –î–æ–±–∞–≤–ª–µ–Ω—ã —é–Ω–∏—Ç-—Ç–µ—Å—Ç—ã –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤

**–ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã:**
- `src/database/fts_config.py` (–Ω–æ–≤—ã–π)
- `tests/test_fts_config.py` (–Ω–æ–≤—ã–π)

---

---

## üö® –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –û–ë–ù–ê–†–£–ñ–ï–ù–ò–ï - 2025-10-19

### –ê–Ω–∞–ª–∏–∑ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

**–î–∞—Ç–∞:** 2025-10-19
**–ò–Ω–∏—Ü–∏–∞—Ç–æ—Ä:** –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –∞–≥–µ–Ω—Ç–æ–≤ (–∞–Ω–∞–ª–∏–∑ –ø–µ—Ä–µ–¥ –ó–∞–¥–∞—á–µ–π 2.3)
**–°—Ç–∞—Ç—É—Å:** –í—ã—è–≤–ª–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è

**–ü—Ä–æ–±–ª–µ–º—ã:**

1. **DataAggregator (–ó–∞–¥–∞—á–∞ 2.2) - –Ω–µ–ø–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è**
   - ‚ùå –ù–µ –∏–∑–≤–ª–µ–∫–∞–µ—Ç `–û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ –ø–æ–∑–∏—Ü–∏–∏` ‚Üí `total_cost`
   - ‚ùå –ù–µ –∏–∑–≤–ª–µ–∫–∞–µ—Ç `–ú–∞—Ç–µ—Ä–∏–∞–ª—ã –†–µ—Å—É—Ä—Å | –°—Ç–æ–∏–º–æ—Å—Ç—å (—Ä—É–±.)` ‚Üí `materials_cost`
   - ‚ùå –ù–µ –≤—ã—á–∏—Å–ª—è–µ—Ç `resources_cost`
   - ‚úÖ –î–∞–Ω–Ω—ã–µ –î–û–°–¢–£–ü–ù–´ –≤ Excel
   - **–†–µ—à–µ–Ω–∏–µ:** –ó–∞–¥–∞—á–∞ 2.2.1 HOTFIX

2. **Schema (–ó–∞–¥–∞—á–∞ 1.2) - –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å DataAggregator**
   - ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∫–æ–ª–æ–Ω–∫–∞ `composition TEXT` –¥–ª—è JSON –¥–∞–Ω–Ω—ã—Ö
   - ‚ùå CHECK constraint `resource_type IN (...)` –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º —Å `row_type = '–†–µ—Å—É—Ä—Å'`
   - **–†–µ—à–µ–Ω–∏–µ:** –ó–∞–¥–∞—á–∞ 2.2.2 HOTFIX

3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ resource type classifier**
   - ‚ùå –ù–µ—Ç –ª–æ–≥–∏–∫–∏ –º–∞–ø–ø–∏–Ω–≥–∞ `row_type` ‚Üí `resource_type`
   - **–†–µ—à–µ–Ω–∏–µ:** –ó–∞–¥–∞—á–∞ 2.2.3 HOTFIX

**–í–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ:**
- üö´ –ë–õ–û–ö–ò–†–£–ï–¢ –ó–∞–¥–∞—á—É 2.3 (DatabasePopulator)
- üö´ –ë–õ–û–ö–ò–†–£–ï–¢ –ó–∞–¥–∞—á—É 2.4 (Build script)
- üö´ –ë–õ–û–ö–ò–†–£–ï–¢ –≤–µ—Å—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—É—Ç—å –ø—Ä–æ–µ–∫—Ç–∞

**–î–µ–π—Å—Ç–≤–∏—è:**
- –°–æ–∑–¥–∞–Ω—ã –∑–∞–¥–∞—á–∏ 2.2.1, 2.2.2, 2.2.3 –≤ `active-tasks.md`
- –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–µ–∫—Ü–∏—è "–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ó–ê–î–ê–ß–ò (HOTFIX)"
- –ó–∞–¥–∞—á–∞ 2.3 –ø–æ–º–µ—á–µ–Ω–∞ –∫–∞–∫ –ë–õ–û–ö–ò–†–û–í–ê–ù–û

**–í—ã–≤–æ–¥—ã:**
- ‚úÖ –†–∞–Ω–Ω–µ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏–ª–æ cascade failure
- üìù –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —É—Å–∏–ª–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
- üìù –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è integration —Ç–µ—Å—Ç—ã –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —Ñ–∞–∑—ã

---

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

**–í—Å–µ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ –∑–∞–¥–∞—á:** 4
**–§–∞–∑—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã:** –§–ê–ó–ê 1 (–ø–æ–ª–Ω–æ—Å—Ç—å—é)
**–ü–µ—Ä–∏–æ–¥:** 18-19 –æ–∫—Ç—è–±—Ä—è 2025
**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞—Ö–æ–¥–∫–∏:** 3 (—Ç—Ä–µ–±—É—é—Ç HOTFIX)
